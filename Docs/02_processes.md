# Electron의 프로세스

## Process Model

- Chromium의 멀티 프로세스 아키텍처를 상속받음 (모던 웹 브라우저와 유사)

### 싱글 프로세스가 아닌 이유

- 웹 브라우저는 복잡한 애플리케이션
- 웹 컨텐츠를 표시하는 핵심 기능 외의 부가적인 동작이 많음
- 이전에는 싱글 프로세스를 사용했지만 열려있는 탭 중 웹 사이트 하나가 충돌하거나 응답하지 않으면 전체 브라우저에 영향을 미치는 문제가 있었음

### 멀티 프로세스

- 위 문제를 해결하기 위해 각 탭이 자체 프로세스에서 렌더링되어 웹 페이지의 버그나 악성코드가 앱 전체에 영향을 주지 않도록 제한
- 싱글 브라우저 프로세스가 전체 애플리케이션의 생명 주기를 제어
- Electron이 매우 유사하게 설계됨
  - 개발자가 제어해야 할 프로세스: main, renderer

### 메인 프로세스

- 각 Electron 앱은 1개의 메인 프로세스를 가짐
- 메인 프로세스는 진입점 역할
- Node.js 환경에서 작동
  - `require` 모듈들과 모든 Node.js의 API 사용 가능

**창 관리**

- 메인 프로세스의 주요 목적: 어플리케이션 창 생성&관리
- `BrowserWindow` 모듈 사용
  - `BrowserWindow` 클래스의 각 인스턴스는 각각의 렌더러 프로세스에서 웹 페이지를 로드하여 어플리케이션 창을 생성
  - `webContents` 객체를 사용해 메인 프로세스와 웹 컨텐츠를 상호작용
  - EventEmitter이기 때문에 사용자 이벤트 핸들러를 추가 가능 (ex. minimizing/maximizing window)
    - \*EventEmitter: Node.js에서 많이 사용하는 라이브러리로, 이벤트와 리스너를 추적
  - 종료되면 렌더러 프로세스도 종료됨

**애플리케이션 생명 주기**

- 메인 프로세스는 Electron의 앱 모듈을 통해 애플리케이션의 생명 주기를 제어
- 앱 모듈은 사용자 지정 동작을 추가할 수 있는 대규모의 이벤트와 메서드를 제공
  ```js
  // non-macOS 플랫폼에서 열려있는 창이 없을 때 앱 종료
  app.on("window-all-closed", () => {
    if (process.platform !== "darwin") app.quit();
  });
  ```

**네이티브 APIs**

- Electron의 기능을 웹 콘텐츠의 Chromium wrapper 이상으로 확장하기 위해 메인 프로세스는 사용자의 운영 체제와 상호 작용할 수 있는 사용자 지정 API를 추가
- 메뉴, 대화상자, 트레이 아이콘고 같은 기본 데스크톱 기능을 제어하는 다양한 모듈을 제공
